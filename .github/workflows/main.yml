name: VM 16GB Tailscale com Senha
on: 
  workflow_dispatch:

jobs:
  start-vm:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Configurar Usuario e Senha
        run: |
          # Define a senha para o usuário 'runner'
          # Substitua 'suasenha123' pela senha que você desejar
          echo "runner:suasenha123" | sudo chpasswd
          echo "Senha configurada com sucesso!"

      - name: Conectar ao Tailscale
        uses: tailscale/github-action@v2
        with:
          authkey: ${{ secrets.TAILSCALE_AUTHKEY }}
          # Removi o --ssh para usarmos a senha padrão do sistema
          args: --accept-dns=false

      - name: Manter VM Ativa
        timeout-minutes: 360
        run: |
          echo "VM PRONTA!"
          echo "Usuario: runner"
          echo "Senha: suasenha123"
          while true; do sleep 30; done
